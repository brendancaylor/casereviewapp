using System;
using System.Collections.Generic;
using System.Data;
using System.Data.Entity;
using System.Linq;
using System.Net;
using System.Web;
using System.Web.Mvc;
using System.Web.Script.Serialization;
using CaseReview.BusinessLogic;
using CaseReview.WebApp.Models;

namespace CaseReview.WebApp.Controllers
{
    public class AdminListController : Controller
    {
        private GenericLogic<DataLayer.Models.CaseReviewType> crtLogic = new GenericLogic<DataLayer.Models.CaseReviewType>();
        private GenericLogic<DataLayer.Models.Section> secLogic = new GenericLogic<DataLayer.Models.Section>();
        // GET: CaseReviewTypes

        public ActionResult CaseReviewTypes()
        {
            var data = crtLogic.GetAll();
            var model = data.OrderBy(o => o.DisplayOrder).ToList().Select(x => new Models.BaseModel
            {
                DisplayOrder = x.DisplayOrder,
                ID = x.ID,
                IsActive = x.IsActive,
                Name = x.TypeName
            });


            var jsonSerializer = new JavaScriptSerializer();
            var json = jsonSerializer.Serialize(model);
            ViewBag.Json = json;
            string rootUrl = Url.Content("~/");

            ViewBag.UrlApiAdd = rootUrl + "api/adminlist/addCaseType";
            ViewBag.UrlApiUpdate = rootUrl + "api/adminlist/updateCaseType";
            ViewBag.UrlApiReorder = rootUrl + "api/adminlist/reorderCaseTypes";
            ViewBag.Title = "Case Review Types";
            return View("Index");
        }

        public ActionResult Sections()
        {
            ViewBag.Title = "Sections";
            var data = secLogic.GetAll();
            var model = data.OrderBy(o => o.DisplayOrder).ToList().Select(x => new Models.BaseModel
            {
                DisplayOrder = x.DisplayOrder,
                ID = x.ID,
                IsActive = x.IsActive,
                Name = x.SectionName
            });


            var jsonSerializer = new JavaScriptSerializer();
            var json = jsonSerializer.Serialize(model);
            ViewBag.Json = json;
            string rootUrl = Url.Content("~/");

            ViewBag.UrlApiAdd = rootUrl + "api/adminlist/addSection";
            ViewBag.UrlApiUpdate = rootUrl + "api/adminlist/updateSection";
            ViewBag.UrlApiReorder = rootUrl + "api/adminlist/reorderSections";

            return View("Index");
        }

    }
}